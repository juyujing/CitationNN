11-2-2025 11:47
(base) caleb@ubuntu22:~/MCAP$ conda activate dirrec                                                                                                      [794/794]
(dirrec) caleb@ubuntu22:~/MCAP$ python -u main.py --seed 2021 --dataset citeulike --att_dropout 1 --step 5 --lr 0.001 --l2 1e-6  --pool sum --load_ii_sort 50 --co
ntext_hops 1 --with_sim 1 --with_user 1 --e 0.001 --with_uu_co_author 0 --with_ii_co_author 0 --with_uu_co_venue 0 --with_ii_co_venue 0 --gpu_id 0 --gnn CitationN
N --batch_size 1024                                                                                                                                               
time of start:  2025-02-11 11:19:46.765060                                                                                                                        
reading train and test user-item set ...                                                                                                                          
n_users:  5551  n_items:  16980                                                                                                                                   
n_train:  165992        n_test:  23878  n_valid:  20634                                                                                                           
n_inters:  210504                                                                                                                                                 
get_adj_features_list ...                                                                                                                                         
        ==========convert user-item into adj mat done.                                                                                                            
        ==========convert user-user data into adj mat done.                                                                                                       
load file:  data/citeulike/citeulike_oag_similarity8_sort_50.txt                                                                                                  
        ==========convert item-item data into adj mat done.                                                                                                       
building the adj mat ...                                                                                                                                          
building the citation graph ...                                                                                                                                   
loading over ...                                                                                                                                                                                 [770/770]
search_space:  {'dim': [512], 'context_hops': [1], 'l2': [1e-06]}                                                                                                 ntext_hops 1 --with_sim 1 --with_user 1 
trials:  1                                                                                                                                                                                                
[I 2025-02-11 11:20:21,122] A new study created in memory with name: no-name-3b14a51e-132c-4af4-84ec-0ff38f740afe                                                                                         
Namespace(dataset='citeulike', data_path='data/', seed=2021, heatkernel=False, learnkernel=False, t_u=2, t_i=2, gnn='CitationNN', epoch=1000, batch_size=1024, tes                                        
t_batch_size=256, dim=512, l2=1e-06, e=0.001, lr=0.001, mess_dropout=False, mess_dropout_rate=0.1, edge_dropout=False, edge_dropout_rate=0.1, batch_test_flag=True                                        
, ns='rns', K=1, n_negs=1, pool='sum', cuda=True, gpu_id=0, Ks='[5, 10, 20]', test_flag='part', context_hops=1, step=5, runs=1, save=True, out_dir='./weights/', w                                        
ith_user=1, with_sim=1, with_uu_co_author=0, with_ii_co_author=0, with_uu_co_venue=0, with_ii_co_venue=0, top_u=5, load_ii_sort=50, att_dropout=1, early_stop=5, a                                        
lpha=1)    
start training ...                                                                                                                                                
Start hyper parameters:  {'dim': 512, 'l2': 1e-06, 'hops': 1}                                                                                                     
loss: 69.75 time:  12.78 s                                                                                                                                        
+-------+-------+------------------+----------
------+-------+------------------------------------+------------------------------------+------------------------------------+------------------------------------
+                                                                                                                                                                 
| Phase | Epoch | training time(s) | tesing time(s) |  Loss |               recall               |                ndcg                |             hit_ratio     
         |             precision              |                                                                                                                   
+-------+-------+------------------+----------------+-------+------------------------------------+------------------------------------+---------------------------
---------+------------------------------------+                                                                                                                   
|  Test |   0   |      12.78       |     10.28      | 69.75 | [0.00076033 0.00152629 0.00256445] | [0.00065053 0.0010046  0.00142442] | [0.00270222 0.00576473 0.0
1062872] | [0.00054044 0.00057647 0.00060349] |                                                                                                                   
| Valid |   0   |      12.78       |     10.43      | 69.75 | [0.00111015 0.00277413 0.00467917] | [0.00097358 0.00166124 0.00226665] | [0.00396325 0.00900739 0.0
1567285] | [0.00086471 0.0010989  0.00091875] |                                                                                                                   
+-------+-------+------------------+----------------+-------+------------------------------------+------------------------------------+---------------------------
---------+------------------------------------+                                                                                                                   
loss: 36.82 time:  12.58 s                                                                                                                                        
using time 12.5832s, training loss at epoch 1: 36.8150                                                                                                            
loss: 23.88 time:  12.27 s                                                                                                                                        
using time 12.2668s, training loss at epoch 2: 23.8825                                                                                                            
loss: 18.03 time:  12.57 s                                                                                                                                        
using time 12.5746s, training loss at epoch 3: 18.0294                                                                                                            
loss: 15.33 time:  12.82 s                                                                                                                                        
using time 12.8159s, training loss at epoch 4: 15.3338
loss: 13.53 time:  15.1 s                                                                                                                                         
+-------+-------+------------------+----------------+-------+------------------------------------+------------------------------------+---------------------------
---------+------------------------------------+                                                                                                                   
| Phase | Epoch | training time(s) | tesing time(s) |  Loss |               recall               |                ndcg                |             hit_ratio     
         |             precision              |                                                                                                                   
+-------+-------+------------------+----------------+-------+------------------------------------+------------------------------------+---------------------------
---------+------------------------------------+                                                                                                                   
|  Test |   5   |       15.1       |     10.67      | 13.53 | [0.00237864 0.00524006 0.00976692] | [0.00217848 0.00330279 0.00485028] | [0.00720591 0.01603315 0.0
2990452] | [0.00162133 0.00178346 0.00168438] |                                                                                                                   
| Valid |   5   |       15.1       |     11.05      | 13.53 | [0.00617735 0.01215637 0.02259266] | [0.00706432 0.00879906 0.01199544] | [0.02251847 0.03602954 0.0
6034949] | [0.00493605 0.00493605 0.0046298 ] |                                                                                                                   
+-------+-------+------------------+----------------+-------+------------------------------------+------------------------------------+---------------------------
---------+------------------------------------+                                                                                                                   
loss: 11.96 time:  14.72 s                                                                                                                                        
using time 14.7214s, training loss at epoch 6: 11.9619                                                                                                            
loss: 10.7 time:  16.41 s                                                                                                                                         
using time 16.4062s, training loss at epoch 7: 10.7035                                                                                                            
loss: 9.73 time:  16.08 s                                                                                                                                         
using time 16.0816s, training loss at epoch 8: 9.7318                                                                                                             
loss: 8.93 time:  14.72 s                                                                                                                                         
using time 14.7230s, training loss at epoch 9: 8.9254                                                                                                             
loss: 8.17 time:  16.03 s                             




+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+----------------------------
--------+------------------------------------+                                                                                                                    
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio      
        |             precision              |                                                                                                                    
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+----------------------------
--------+------------------------------------+                                                                                                                    
|  Test |  145  |      12.58       |     10.82      | 0.63 | [0.01763133 0.03098968 0.0552887 ] | [0.0142287  0.01976818 0.02814929] | [0.04323545 0.07422086 0.13
348946] | [0.00983607 0.00875518 0.00814268] |                                                                                                                    
| Valid |  145  |      12.58       |     11.13      | 0.63 | [0.05169705 0.08724255 0.13064513] | [0.04569558 0.05807442 0.07197073] | [0.11043055 0.17654477 0.24
950459] | [0.02824716 0.02469825 0.01992434] |                                                                                                                    
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+----------------------------
--------+------------------------------------+                                                                                                                    
loss: 0.63 time:  12.66 s                                                                                                                                         
using time 12.6623s, training loss at epoch 146: 0.6295                                                                                                           
loss: 0.63 time:  12.37 s                                                                                                                                         
using time 12.3703s, training loss at epoch 147: 0.6283                                                                                                           
loss: 0.62 time:  12.52 s                                                                                                                                         
using time 12.5232s, training loss at epoch 148: 0.6247                                                                                                           
loss: 0.63 time:  12.29 s                                                                                                                                         
using time 12.2850s, training loss at epoch 149: 0.6252                                                                                                           
loss: 0.63 time:  12.47 s                                                                                                                                         
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+----------------------------
--------+------------------------------------+                                                                                                                    
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio      
        |             precision              |                                                                                                                    
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+----------------------------
--------+------------------------------------+                                                                                                                    
|  Test |  150  |      12.47       |     10.81      | 0.63 | [0.01804283 0.03262801 0.05482866] | [0.01470903 0.02074738 0.02841527] | [0.04521708 0.08106647 0.13
40299 ] | [0.01016033 0.00940371 0.00814268] |                                                                                                                    
| Valid |  150  |      12.47       |      10.8      | 0.63 | [0.05219078 0.08184462 0.13115758] | [0.04769798 0.05760891 0.07311991] | [0.11259233 0.16555576 0.25
220681] | [0.02867952 0.02372545 0.0202396 ] |                                                                                                                    
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+----------------------------
--------+------------------------------------+                                                                                                                    
loss: 0.62 time:  12.59 s                                                                                                                                         
using time 12.5891s, training loss at epoch 151: 0.6221                                                                                                           
loss: 0.62 time:  12.46 s                                                                                                                                         
using time 12.4578s, training loss at epoch 152: 0.6236                                                                                                           
loss: 0.62 time:  12.27 s                                                                                                                                         
using time 12.2687s, training loss at epoch 153: 0.6204                                                                                                           
loss: 0.62 time:  12.54 s                                                                                                                                         
using time 12.5445s, training loss at epoch 154: 0.6210                                                                                                           
loss: 0.62 time:  12.28 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+----------------------------
--------+------------------------------------+                                                                                                                    
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio      
        |             precision              |                                                                                                                    
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+----------------------------
--------+------------------------------------+                                                                                                                    
|  Test |  155  |      12.28       |     10.94      | 0.62 | [0.01825783 0.03191654 0.05498521] | [0.01510888 0.02077574 0.02864692] | [0.04575752 0.07692308 0.12
988651] | [0.0101243  0.00909746 0.00799856] |                                                                                                                    
| Valid |  155  |      12.28       |     11.01      | 0.62 | [0.05096895 0.08592714 0.13312751] | [0.04570917 0.05764772 0.07263169] | [0.10700775 0.17132048 0.24
968474] | [0.02795893 0.02421185 0.02018555] |                                                                                                                    
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+----------------------------
--------+------------------------------------+                                                                                                                    
loss: 0.61 time:  12.58 s                                                                                                                                         
using time 12.5788s, training loss at epoch 156: 0.6149                                                                                                           
loss: 0.62 time:  12.47 s                                                                                                                                         
using time 12.4698s, training loss at epoch 157: 0.6164                                                                                                           
loss: 0.62 time:  12.67 s               
using time 12.6712s, training loss at epoch 158: 0.6163                          
loss: 0.62 time:  12.38 s               
using time 12.3842s, training loss at epoch 159: 0.6178                          
loss: 0.62 time:  12.64 s               
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+----------------------------
--------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio      
        |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+----------------------------
--------+------------------------------------+
|  Test |  160  |      12.64       |     10.87      | 0.62 | [0.01776786 0.03063703 0.05475524] | [0.01437588 0.0197828  0.02806769] | [0.04287516 0.07422086 0.13
132769] | [0.00965592 0.00864709 0.00803459] |
| Valid |  160  |      12.64       |     11.17      | 0.62 | [0.04910141 0.08230915 0.12736404] | [0.04475809 0.05544028 0.06957255] | [0.10430553 0.16249324 0.24
157809] | [0.02842731 0.02376148 0.01946496] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+----------------------------
--------+------------------------------------+
loss: 0.61 time:  12.67 s               
using time 12.6681s, training loss at epoch 161: 0.6143                          
loss: 0.61 time:  12.3 s                
using time 12.3038s, training loss at epoch 162: 0.6136                          
loss: 0.61 time:  12.54 s               
using time 12.5357s, training loss at epoch 163: 0.6132                          
loss: 0.61 time:  12.53 s               
using time 12.5265s, training loss at epoch 164: 0.6141                          
loss: 0.61 time:  12.51 s 
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+----------------------------
--------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio      
        |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+----------------------------
--------+------------------------------------+
|  Test |  165  |      12.51       |     11.38      | 0.61 | [0.0186469  0.03264558 0.05611884] | [0.01556986 0.0213907  0.02935201] | [0.04467663 0.07854441 0.13
150784] | [0.01037651 0.00929562 0.00812466] |
| Valid |  165  |      12.51       |      11.0      | 0.61 | [0.05046647 0.0844117  0.13255266] | [0.04689203 0.05844431 0.07345984] | [0.10700775 0.16753738 0.24
770312] | [0.02813907 0.02428391 0.02007746] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+----------------------------
--------+------------------------------------+
loss: 0.61 time:  12.41 s               
using time 12.4137s, training loss at epoch 166: 0.6087                          
loss: 0.61 time:  12.54 s               
using time 12.5367s, training loss at epoch 167: 0.6128                          
loss: 0.61 time:  12.32 s               
using time 12.3207s, training loss at epoch 168: 0.6062                          
loss: 0.61 time:  12.5 s                
using time 12.5036s, training loss at epoch 169: 0.6081                          
loss: 0.61 time:  12.5 s                
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+----------------------------
--------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio      
        |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+----------------------------
--------+------------------------------------+
|  Test |  170  |       12.5       |     11.28      | 0.61 | [0.01893528 0.03185225 0.05515483] | [0.01572912 0.02118773 0.0290941 ] | [0.04521708 0.07566204 0.13
06071 ] | [0.01026842 0.00897136 0.00799856] |
| Valid |  170  |       12.5       |     10.99      | 0.61 | [0.05322455 0.08618162 0.13210004] | [0.04679146 0.05849329 0.07295868] | [0.110971   0.16951901 0.25
148622] | [0.02788687 0.02403171 0.01949198] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+----------------------------
--------+------------------------------------+
loss: 0.61 time:  12.63 s               
using time 12.6322s, training loss at epoch 171: 0.6101                          
loss: 0.6 time:  12.28 s                
using time 12.2846s, training loss at epoch 172: 0.6041                          
loss: 0.6 time:  12.52 s                
using time 12.5201s, training loss at epoch 173: 0.6039                          
loss: 0.6 time:  12.31 s                
using time 12.3090s, training loss at epoch 174: 0.6027                          
loss: 0.61 time:  12.45 s 
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+----------------------------
--------+------------------------------------+                                                                                                                    
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio      
        |             precision              |                                                                                                                    
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+----------------------------
--------+------------------------------------+                                                                                                                    
|  Test |  175  |      12.45       |     10.99      | 0.61 | [0.01748093 0.03231243 0.05285929] | [0.01444655 0.02057178 0.02750358] | [0.04323545 0.07620249 0.12
574311] | [0.0098721  0.00918753 0.00764727] |                                                                                                                    
| Valid |  175  |      12.45       |     10.97      | 0.61 | [0.05288902 0.08309466 0.13155248] | [0.04683626 0.05725549 0.07255031] | [0.11205188 0.16879841 0.24
752297] | [0.02903981 0.02424788 0.02022158] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+----------------------------
--------+------------------------------------+
loss: 0.61 time:  12.58 s               
using time 12.5834s, training loss at epoch 176: 0.6096                          
loss: 0.61 time:  12.47 s               
using time 12.4655s, training loss at epoch 177: 0.6058                          
loss: 0.6 time:  12.33 s                
using time 12.3290s, training loss at epoch 178: 0.6036                          
loss: 0.6 time:  12.48 s                
using time 12.4823s, training loss at epoch 179: 0.6024                          
loss: 0.6 time:  12.51 s                
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+----------------------------
--------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio      
        |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+----------------------------
--------+------------------------------------+
|  Test |  180  |      12.51       |     11.03      | 0.6  | [0.01680987 0.03178401 0.05331032] | [0.01378804 0.020089   0.02738992] | [0.04107368 0.07566204 0.12
376148] | [0.00943974 0.00904342 0.00769231] |
| Valid |  180  |      12.51       |     11.09      | 0.6  | [0.05112097 0.08569188 0.12966745] | [0.04538865 0.05743633 0.07160874] | [0.11115114 0.16807782 0.24
229868] | [0.02749054 0.02334714 0.01923978] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+----------------------------
--------+------------------------------------+
Early stopping is trigger at step: 5 log:0.12966744550531595                     
early stopping at 180, recall@20:0.1331, best_epoch at 155                       
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+----------------------------
--------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio      
        |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+----------------------------
--------+------------------------------------+
|  Test |  155  |      12.28       |     10.94      | 0.62 | [0.01825783 0.03191654 0.05498521] | [0.01510888 0.02077574 0.02864692] | [0.04575752 0.07692308 0.12
988651] | [0.0101243  0.00909746 0.00799856] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+----------------------------
--------+------------------------------------+
2025-02-11_12-16-08                     
Seed: 2021                              
End hyper parameters:  {'dim': 512, 'l2': 1e-06, 'hops': 1}                      
Best valid_ret['recall']:  0.13312751215997287                                   
[I 2025-02-11 12:16:08,461] Trial 0 finished with value: 0.13312751215997287 and parameters: {'dim': 512, 'l2': 1e-06, 'context_hops': 1}. Best is trial 0 with va
lue: 0.13312751215997287.
{'dim': 512, 'l2': 1e-06, 'context_hops': 1}                                     
time of end:  2025-02-11 12:16:08.462158                                         
finished all                            
(dirrec) caleb@ubuntu22:~/MCAP$