11-02-2025 3:11

(dirrec) caleb@ubuntu22:~/MCAP$ python -u main.py --seed 2021 --dataset citeulike --att_dropout 1 --step 5 --lr 0.001 --l2 1e-6  --pool sum --load_ii_sort 50 --context_hops 1 --with_sim 1 --with_user 1 --e 0.001 --with_uu_co_author 0 --with_ii_co_author 0 --with_uu_co_venue 0 --with_ii_co_venue 0 --gpu_id 0 --gnn CitationNN --batch_size 1024
time of start:  2025-02-11 10:22:01.075553
reading train and test user-item set ...
n_users:  5551  n_items:  16980
n_train:  165992        n_test:  23878  n_valid:  20634
n_inters:  210504
get_adj_features_list ...
        ==========convert user-item into adj mat done.
        ==========convert user-user data into adj mat done.
load file:  data/citeulike/citeulike_oag_similarity8_sort_50.txt
        ==========convert item-item data into adj mat done.
building the adj mat ...
building the citation graph ...
loading over ...
search_space:  {'dim': [512], 'context_hops': [1], 'l2': [1e-06]}
trials:  1
[I 2025-02-11 10:22:35,453] A new study created in memory with name: no-name-5bd0e40f-593b-464c-9a7a-f2209564fda8
Namespace(dataset='citeulike', data_path='data/', seed=2021, heatkernel=False, learnkernel=False, t_u=2, t_i=2, gnn='CitationNN', epoch=1000, batch_size=1024, test_batch_size=256, dim=512, l2=1e-06, e=0.001, lr=0.001, mess_dropout=False, mess_dropout_rate=0.1, edge_dropout=False, edge_dropout_rate=0.1, batch_test_flag=True, ns='rns', K=1, n_negs=1, pool='sum', cuda=True, gpu_id=0, Ks='[5, 10, 20]', test_flag='part', context_hops=1, step=5, runs=1, save=True, out_dir='./weights/', with_user=1, with_sim=1, with_uu_co_author=0, with_ii_co_author=0, with_uu_co_venue=0, with_ii_co_venue=0, top_u=5, load_ii_sort=50, att_dropout=1, early_stop=5, alpha=1)
start training ...
Start hyper parameters:  {'dim': 512, 'l2': 1e-06, 'hops': 1}
loss: 69.73 time:  12.55 s
+-------+-------+------------------+----------------+-------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) |  Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+-------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |   0   |      12.55       |     10.44      | 69.73 | [0.00076033 0.00152629 0.00254193] | [0.00065053 0.00100564 0.00141195] | [0.00270222 0.00576473 0.01044857] | [0.00054044 0.00057647 0.00059449] |
| Valid |   0   |      12.55       |     10.42      | 69.73 | [0.00114618 0.00280416 0.00455744] | [0.00099454 0.00168397 0.00223529] | [0.0041434  0.00918753 0.01531256] | [0.00090074 0.00111692 0.00090074] |
+-------+-------+------------------+----------------+-------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 36.82 time:  12.37 s
using time 12.3669s, training loss at epoch 1: 36.8213
loss: 23.9 time:  12.18 s
using time 12.1794s, training loss at epoch 2: 23.9034
loss: 18.04 time:  12.18 s
using time 12.1786s, training loss at epoch 3: 18.0427
loss: 15.35 time:  12.26 s
using time 12.2588s, training loss at epoch 4: 15.3468
loss: 13.55 time:  12.0 s
+-------+-------+------------------+----------------+-------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) |  Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+-------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |   5   |       12.0       |     10.23      | 13.55 | [0.00254378 0.00524906 0.00967084] | [0.00225801 0.00327918 0.0048034 ] | [0.00774635 0.015853   0.02972437] | [0.00172942 0.00176545 0.00166637] |
| Valid |   5   |       12.0       |     10.24      | 13.55 | [0.00636221 0.01203008 0.02303462] | [0.00695962 0.00869862 0.01205526] | [0.02269861 0.03656999 0.06107008] | [0.00479193 0.00493605 0.00470186] |
+-------+-------+------------------+----------------+-------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 11.99 time:  12.28 s
using time 12.2827s, training loss at epoch 6: 11.9949
loss: 10.74 time:  12.0 s
using time 12.0039s, training loss at epoch 7: 10.7362
loss: 9.77 time:  12.21 s
using time 12.2067s, training loss at epoch 8: 9.7663
loss: 8.96 time:  12.23 s
using time 12.2315s, training loss at epoch 9: 8.9623
loss: 8.2 time:  12.31 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |   10  |      12.31       |     10.34      | 8.2  | [0.00358714 0.00763193 0.01554768] | [0.0029181  0.00466925 0.00733404] | [0.00882724 0.02071699 0.04359575] | [0.00201765 0.00237795 0.00245001] |
| Valid |   10  |      12.31       |     10.44      | 8.2  | [0.01021792 0.01798896 0.03767649] | [0.01002282 0.01241809 0.01868119] | [0.02846334 0.04773915 0.0868312 ] | [0.00735003 0.00679157 0.00724194] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 7.52 time:  12.37 s
using time 12.3689s, training loss at epoch 11: 7.5249
loss: 6.83 time:  11.96 s
using time 11.9614s, training loss at epoch 12: 6.8312
loss: 6.23 time:  12.21 s
using time 12.2136s, training loss at epoch 13: 6.2252
loss: 5.73 time:  12.06 s
using time 12.0586s, training loss at epoch 14: 5.7274
loss: 5.28 time:  12.3 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |   15  |       12.3       |      10.6      | 5.28 | [0.00539852 0.01112287 0.02138946] | [0.0041556  0.00657899 0.01010542] | [0.01351108 0.02828319 0.05494505] | [0.00299045 0.00320663 0.00314358] |
| Valid |   15  |       12.3       |     10.45      | 5.28 | [0.01433297 0.02874581 0.05338534] | [0.01451946 0.01938237 0.02647707] | [0.03783102 0.06449288 0.11511439] | [0.01030445 0.01084489 0.0093857 ] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 4.85 time:  12.49 s
using time 12.4916s, training loss at epoch 16: 4.8492
loss: 4.38 time:  12.43 s
using time 12.4318s, training loss at epoch 17: 4.3824
loss: 4.04 time:  12.31 s
using time 12.3081s, training loss at epoch 18: 4.0435
loss: 3.71 time:  12.35 s
using time 12.3467s, training loss at epoch 19: 3.7099
loss: 3.55 time:  12.09 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |   20  |      12.09       |     10.33      | 3.55 | [0.00634904 0.01275219 0.02510295] | [0.00485628 0.0075544  0.01173404] | [0.01603315 0.03368762 0.06413259] | [0.00360295 0.00371104 0.00372005] |
| Valid |   20  |      12.09       |     10.55      | 3.55 | [0.01913277 0.03722107 0.06726739] | [0.01747288 0.02369639 0.0326604 ] | [0.04449649 0.08088633 0.13799315] | [0.01167357 0.01205188 0.01083589] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 3.43 time:  12.29 s
using time 12.2874s, training loss at epoch 21: 3.4271
loss: 3.07 time:  12.32 s
using time 12.3182s, training loss at epoch 22: 3.0734
loss: 2.94 time:  12.35 s
using time 12.3454s, training loss at epoch 23: 2.9433
loss: 2.69 time:  12.16 s
using time 12.1556s, training loss at epoch 24: 2.6882
loss: 2.47 time:  12.52 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |   25  |      12.52       |     10.77      | 2.47 | [0.00659015 0.0131052  0.02815952] | [0.00538669 0.00809764 0.01323177] | [0.01639344 0.03386777 0.07259953] | [0.00371104 0.00380112 0.00416141] |
| Valid |   25  |      12.52       |     10.78      | 2.47 | [0.0206181  0.03920253 0.07171843] | [0.02084511 0.02620582 0.03565819] | [0.04900018 0.08358854 0.14411818] | [0.01437579 0.01277247 0.01131328] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 2.32 time:  12.38 s
using time 12.3829s, training loss at epoch 26: 2.3186
loss: 2.17 time:  12.13 s
using time 12.1260s, training loss at epoch 27: 2.1711
loss: 2.04 time:  12.32 s
using time 12.3185s, training loss at epoch 28: 2.0406
loss: 1.95 time:  12.13 s
using time 12.1336s, training loss at epoch 29: 1.9513
loss: 1.86 time:  12.48 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |   30  |      12.48       |     10.49      | 1.86 | [0.01027043 0.01763211 0.03461157] | [0.00856237 0.01145905 0.01732247] | [0.02702216 0.04539723 0.08737164] | [0.0059809  0.00508017 0.00521528] |
| Valid |   30  |      12.48       |     10.43      | 1.86 | [0.02750436 0.05015384 0.08529642] | [0.02593253 0.03342718 0.04376927] | [0.06233111 0.10556656 0.17348226] | [0.01653756 0.01533057 0.01283553] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 1.77 time:  12.38 s
using time 12.3828s, training loss at epoch 31: 1.7661
loss: 1.7 time:  12.33 s
using time 12.3284s, training loss at epoch 32: 1.7042
loss: 1.61 time:  12.26 s
using time 12.2601s, training loss at epoch 33: 1.6125
loss: 1.54 time:  12.36 s
using time 12.3617s, training loss at epoch 34: 1.5435
loss: 1.5 time:  12.14 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |   35  |      12.14       |     10.44      | 1.5  | [0.0106758  0.01908354 0.03638814] | [0.00886703 0.01232362 0.01819389] | [0.02846334 0.05044136 0.09457755] | [0.00630517 0.00576473 0.00558458] |
| Valid |   35  |      12.14       |     10.59      | 1.5  | [0.03096893 0.05362266 0.08945445] | [0.02827448 0.03531079 0.04571011] | [0.07079805 0.11655558 0.18140876] | [0.01913169 0.01671771 0.01358314] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 1.43 time:  12.44 s
using time 12.4410s, training loss at epoch 36: 1.4288
loss: 1.38 time:  12.35 s
using time 12.3507s, training loss at epoch 37: 1.3764
loss: 1.33 time:  12.37 s
using time 12.3731s, training loss at epoch 38: 1.3313
loss: 1.31 time:  12.2 s
using time 12.1976s, training loss at epoch 39: 1.3081
loss: 1.25 time:  12.41 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |   40  |      12.41       |     10.56      | 1.25 | [0.01130558 0.0207132  0.03692105] | [0.00928438 0.01305709 0.01859235] | [0.0313457  0.05458476 0.09601874] | [0.00684561 0.00619708 0.00562962] |
| Valid |   40  |      12.41       |     10.45      | 1.25 | [0.03427432 0.05737066 0.09569188] | [0.03298226 0.04021805 0.05100881] | [0.07710322 0.12214015 0.19293821] | [0.02114934 0.01835705 0.01442083] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 1.21 time:  12.4 s
using time 12.3986s, training loss at epoch 41: 1.2114
loss: 1.18 time:  12.19 s
using time 12.1886s, training loss at epoch 42: 1.1781
loss: 1.16 time:  12.36 s
using time 12.3597s, training loss at epoch 43: 1.1582
loss: 1.43 time:  12.24 s
using time 12.2379s, training loss at epoch 44: 1.4272
loss: 1.39 time:  12.21 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |   45  |      12.21       |     11.05      | 1.39 | [0.01080082 0.02138253 0.03800215] | [0.00900763 0.01340868 0.01909366] | [0.03008467 0.05782742 0.10250405] | [0.00648532 0.00635921 0.00584579] |
| Valid |   45  |      12.21       |     10.63      | 1.39 | [0.03215563 0.05436091 0.09181017] | [0.02960941 0.03629146 0.04731411] | [0.07187894 0.12051883 0.19041614] | [0.01960007 0.01657359 0.01386237] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 1.25 time:  12.47 s
using time 12.4733s, training loss at epoch 46: 1.2536
loss: 1.11 time:  12.69 s
using time 12.6918s, training loss at epoch 47: 1.1114
loss: 1.04 time:  12.37 s
using time 12.3676s, training loss at epoch 48: 1.0373
loss: 1.0 time:  12.5 s
using time 12.4981s, training loss at epoch 49: 1.0006
loss: 0.96 time:  12.42 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |   50  |      12.42       |     10.59      | 0.96 | [0.01318531 0.02197607 0.04167174] | [0.01093391 0.0145428  0.02123962] | [0.03422807 0.05692668 0.10610701] | [0.00742209 0.00644929 0.0062241 ] |
| Valid |   50  |      12.42       |     10.56      | 0.96 | [0.03590748 0.06190103 0.09862848] | [0.03513214 0.04320254 0.05420235] | [0.08232751 0.13096739 0.19852279] | [0.02168979 0.01864529 0.01518645] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 0.96 time:  12.54 s
using time 12.5414s, training loss at epoch 51: 0.9623
loss: 0.94 time:  12.25 s
using time 12.2536s, training loss at epoch 52: 0.9421
loss: 0.93 time:  12.43 s
using time 12.4256s, training loss at epoch 53: 0.9254
loss: 0.92 time:  12.22 s
using time 12.2243s, training loss at epoch 54: 0.9204
loss: 0.9 time:  12.43 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |   55  |      12.43       |     10.77      | 0.9  | [0.01153935 0.02254541 0.04129407] | [0.00996173 0.01454346 0.02092312] | [0.03116556 0.0589083  0.10448568] | [0.00666547 0.00664745 0.00618807] |
| Valid |   55  |      12.43       |     10.46      | 0.9  | [0.03674168 0.06023745 0.10063012] | [0.03311798 0.04058337 0.05257902] | [0.08196721 0.12772473 0.20086471] | [0.02212214 0.01884345 0.01550171] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 0.9 time:  12.45 s
using time 12.4541s, training loss at epoch 56: 0.8964
loss: 0.87 time:  12.32 s
using time 12.3205s, training loss at epoch 57: 0.8743
loss: 0.87 time:  12.18 s
using time 12.1843s, training loss at epoch 58: 0.8721
loss: 0.86 time:  12.35 s
using time 12.3533s, training loss at epoch 59: 0.8600
loss: 0.85 time:  12.6 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |   60  |       12.6       |     10.52      | 0.85 | [0.01324439 0.02424532 0.04267417] | [0.01086917 0.01540972 0.02172743] | [0.03440821 0.06359215 0.10970996] | [0.00749415 0.00702576 0.00640425] |
| Valid |   60  |       12.6       |     10.73      | 0.85 | [0.03827283 0.06286747 0.10082935] | [0.03570068 0.04305267 0.05438943] | [0.08340839 0.1340299  0.20789047] | [0.02302288 0.01891551 0.01532156] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 0.84 time:  12.28 s
using time 12.2753s, training loss at epoch 61: 0.8412
loss: 0.83 time:  12.33 s
using time 12.3268s, training loss at epoch 62: 0.8344
loss: 0.83 time:  12.35 s
using time 12.3517s, training loss at epoch 63: 0.8330
loss: 0.82 time:  12.17 s
using time 12.1682s, training loss at epoch 64: 0.8245
loss: 0.82 time:  12.39 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |   65  |      12.39       |     10.44      | 0.82 | [0.01271252 0.02315357 0.04210953] | [0.01072877 0.01501197 0.02144393] | [0.03314718 0.06016934 0.10880922] | [0.00724194 0.00679157 0.00629616] |
| Valid |   65  |      12.39       |     10.67      | 0.82 | [0.03851452 0.06435041 0.10235684] | [0.03640764 0.04405789 0.05565585] | [0.08412899 0.13511079 0.20410737] | [0.02421185 0.01987029 0.01630337] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 0.81 time:  12.42 s
using time 12.4196s, training loss at epoch 66: 0.8102
loss: 0.81 time:  12.34 s
using time 12.3400s, training loss at epoch 67: 0.8052
loss: 0.79 time:  12.13 s
using time 12.1315s, training loss at epoch 68: 0.7940
loss: 0.79 time:  12.26 s
using time 12.2614s, training loss at epoch 69: 0.7881
loss: 0.78 time:  12.29 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |   70  |      12.29       |     10.51      | 0.78 | [0.01452271 0.02677067 0.04766712] | [0.01197166 0.01703403 0.02415734] | [0.0392722  0.07061791 0.12159971] | [0.008539   0.00794451 0.00721492] |
| Valid |   70  |      12.29       |     10.58      | 0.78 | [0.0435838  0.07191388 0.11254908] | [0.04001444 0.04878964 0.0609514 ] | [0.09529814 0.15258512 0.2291479 ] | [0.02637363 0.02188795 0.01738426] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 0.78 time:  12.36 s
using time 12.3609s, training loss at epoch 71: 0.7819
loss: 0.78 time:  12.31 s
using time 12.3056s, training loss at epoch 72: 0.7788
loss: 0.77 time:  12.12 s
using time 12.1214s, training loss at epoch 73: 0.7697
loss: 0.77 time:  12.21 s
using time 12.2089s, training loss at epoch 74: 0.7724
loss: 0.76 time:  11.98 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |   75  |      11.98       |      10.6      | 0.76 | [0.01471965 0.02822633 0.0474033 ] | [0.01212148 0.01773388 0.02434313] | [0.0392722  0.07259953 0.12141956] | [0.00832282 0.00823275 0.00723293] |
| Valid |   75  |      11.98       |     10.47      | 0.76 | [0.0457907  0.07177301 0.11407119] | [0.04122718 0.04918126 0.06179403] | [0.09637903 0.1460998  0.22320303] | [0.02705819 0.0220681  0.01760043] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 0.75 time:  12.34 s
using time 12.3424s, training loss at epoch 76: 0.7489
loss: 0.75 time:  12.33 s
using time 12.3289s, training loss at epoch 77: 0.7484
loss: 0.98 time:  12.26 s
using time 12.2624s, training loss at epoch 78: 0.9822
loss: 1.01 time:  12.21 s
using time 12.2078s, training loss at epoch 79: 1.0124
loss: 0.88 time:  12.33 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |   80  |      12.33       |     10.49      | 0.88 | [0.01336155 0.02569883 0.04712991] | [0.01080697 0.01597765 0.02329556] | [0.03422807 0.06413259 0.11565484] | [0.00745812 0.00729598 0.00692668] |
| Valid |   80  |      12.33       |      10.6      | 0.88 | [0.03752229 0.0685583  0.10818364] | [0.03374755 0.04428953 0.05569239] | [0.08070618 0.13925419 0.20933165] | [0.0228067  0.02127545 0.01635741] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 0.92 time:  12.44 s
using time 12.4447s, training loss at epoch 81: 0.9168
loss: 0.86 time:  12.31 s
using time 12.3095s, training loss at epoch 82: 0.8594
loss: 0.88 time:  12.47 s
using time 12.4692s, training loss at epoch 83: 0.8819
loss: 0.78 time:  12.36 s
using time 12.3583s, training loss at epoch 84: 0.7759
loss: 0.72 time:  12.39 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |   85  |      12.39       |     10.64      | 0.72 | [0.01482369 0.02746658 0.04850515] | [0.01252747 0.01789688 0.02515007] | [0.0392722  0.07205909 0.12286075] | [0.0082868  0.0079265  0.00727797] |
| Valid |   85  |      12.39       |     10.76      | 0.72 | [0.03978976 0.06976873 0.1150943 ] | [0.03739739 0.04727461 0.06109472] | [0.08827238 0.14664025 0.23221041] | [0.02446406 0.02179787 0.01809584] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 0.71 time:  12.27 s
using time 12.2695s, training loss at epoch 86: 0.7108
loss: 0.7 time:  12.37 s
using time 12.3687s, training loss at epoch 87: 0.7042
loss: 0.7 time:  12.12 s
using time 12.1185s, training loss at epoch 88: 0.6991
loss: 0.69 time:  12.32 s
using time 12.3249s, training loss at epoch 89: 0.6923
loss: 0.69 time:  12.36 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |   90  |      12.36       |     10.61      | 0.69 | [0.01333878 0.0279778  0.04917619] | [0.0110933  0.01715519 0.02451554] | [0.0358494  0.07025761 0.12466222] | [0.00753017 0.00796253 0.00737705] |
| Valid |   90  |      12.36       |     10.69      | 0.69 | [0.04467829 0.07303383 0.112799  ] | [0.04148657 0.05065509 0.06246948] | [0.09655918 0.15168438 0.22572509] | [0.02655377 0.02278869 0.01760944] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 0.69 time:  12.49 s
using time 12.4866s, training loss at epoch 91: 0.6892
loss: 0.68 time:  12.18 s
using time 12.1757s, training loss at epoch 92: 0.6828
loss: 0.69 time:  12.49 s
using time 12.4908s, training loss at epoch 93: 0.6866
loss: 0.69 time:  12.44 s
using time 12.4424s, training loss at epoch 94: 0.6880
loss: 0.69 time:  12.25 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |   95  |      12.25       |     10.63      | 0.69 | [0.01604629 0.03111764 0.04967184] | [0.01358577 0.01989188 0.02623803] | [0.04125383 0.07782382 0.12304089] | [0.00900739 0.00884525 0.00734102] |
| Valid |   95  |      12.25       |     10.57      | 0.69 | [0.04664462 0.07607221 0.11695689] | [0.04232149 0.05183231 0.06402282] | [0.09818051 0.15366601 0.22896775] | [0.02727436 0.02318501 0.01804179] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 0.68 time:  12.51 s
using time 12.5071s, training loss at epoch 96: 0.6797
loss: 0.68 time:  12.47 s
using time 12.4667s, training loss at epoch 97: 0.6793
loss: 0.68 time:  12.4 s
using time 12.4006s, training loss at epoch 98: 0.6819
loss: 0.68 time:  12.37 s
using time 12.3731s, training loss at epoch 99: 0.6812
loss: 0.68 time:  12.25 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |  100  |      12.25       |     10.66      | 0.68 | [0.01765338 0.03122305 0.05354439] | [0.01472134 0.02040654 0.02804402] | [0.04575752 0.07854441 0.1306071 ] | [0.00994415 0.00907945 0.00800757] |
| Valid |  100  |      12.25       |     10.84      | 0.68 | [0.04750514 0.07809635 0.11850408] | [0.0442741  0.05379303 0.06609441] | [0.10232391 0.16105206 0.23455233] | [0.02835525 0.02340119 0.01842911] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 0.68 time:  12.36 s
using time 12.3561s, training loss at epoch 101: 0.6771
loss: 0.67 time:  12.36 s
using time 12.3633s, training loss at epoch 102: 0.6734
loss: 0.68 time:  12.49 s
using time 12.4895s, training loss at epoch 103: 0.6765
loss: 0.67 time:  12.56 s
using time 12.5601s, training loss at epoch 104: 0.6736
loss: 0.67 time:  12.44 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |  105  |      12.44       |     10.66      | 0.67 | [0.01647236 0.02976965 0.05188075] | [0.01319617 0.01889115 0.0264826 ] | [0.04251486 0.07440101 0.12862547] | [0.00918753 0.00879121 0.00784543] |
| Valid |  105  |      12.44       |     10.57      | 0.67 | [0.0485151  0.08068846 0.12266795] | [0.04569496 0.05581384 0.06867045] | [0.10754819 0.16537561 0.23995676] | [0.02932805 0.02446406 0.01921275] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 0.67 time:  12.47 s
using time 12.4691s, training loss at epoch 106: 0.6715
loss: 0.67 time:  12.16 s
using time 12.1561s, training loss at epoch 107: 0.6737
loss: 0.67 time:  12.51 s
using time 12.5148s, training loss at epoch 108: 0.6722
loss: 0.82 time:  12.22 s
using time 12.2203s, training loss at epoch 109: 0.8222
loss: 0.91 time:  12.54 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |  110  |      12.54       |     10.57      | 0.91 | [0.01244124 0.0246619  0.04664449] | [0.01006158 0.01522275 0.02280428] | [0.03404792 0.06629436 0.12051883] | [0.00709782 0.00727797 0.00705278] |
| Valid |  110  |      12.54       |     11.19      | 0.91 | [0.04091301 0.07280218 0.11417435] | [0.03515803 0.04635426 0.05864186] | [0.08737164 0.14573951 0.2215817 ] | [0.02367141 0.02235633 0.01745631] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 1.05 time:  12.49 s
using time 12.4898s, training loss at epoch 111: 1.0513
loss: 0.9 time:  12.42 s
using time 12.4179s, training loss at epoch 112: 0.9000
loss: 0.72 time:  12.18 s
using time 12.1784s, training loss at epoch 113: 0.7221
loss: 0.68 time:  12.4 s
using time 12.3976s, training loss at epoch 114: 0.6765
loss: 0.66 time:  12.25 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |  115  |      12.25       |     10.83      | 0.66 | [0.0165111  0.02987865 0.05176923] | [0.01378587 0.01927767 0.0266256 ] | [0.04431634 0.07692308 0.12700414] | [0.00969195 0.00880922 0.00762926] |
| Valid |  115  |      12.25       |     10.82      | 0.66 | [0.04545185 0.07994532 0.12436374] | [0.04105397 0.05230694 0.06554582] | [0.10016213 0.16177265 0.23851558] | [0.02752657 0.0239056  0.01862727] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 0.65 time:  12.45 s
using time 12.4467s, training loss at epoch 116: 0.6536
loss: 0.65 time:  12.47 s
using time 12.4736s, training loss at epoch 117: 0.6510
loss: 0.65 time:  12.42 s
using time 12.4213s, training loss at epoch 118: 0.6468
loss: 0.65 time:  12.14 s
using time 12.1414s, training loss at epoch 119: 0.6458
loss: 0.65 time:  12.36 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |  120  |      12.36       |     10.72      | 0.65 | [0.01757812 0.03117731 0.05402714] | [0.01470049 0.02047043 0.02830346] | [0.04521708 0.07962529 0.13366961] | [0.00961989 0.00897136 0.00807062] |
| Valid |  120  |      12.36       |     10.75      | 0.65 | [0.04912315 0.08288525 0.12726201] | [0.04493771 0.05666663 0.06994037] | [0.10502612 0.1660962  0.24446046] | [0.02806701 0.02514862 0.01937489] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 0.65 time:  12.47 s
using time 12.4701s, training loss at epoch 121: 0.6457
loss: 0.64 time:  12.2 s
using time 12.2007s, training loss at epoch 122: 0.6402
loss: 0.64 time:  12.37 s
using time 12.3722s, training loss at epoch 123: 0.6413
loss: 0.64 time:  12.33 s
using time 12.3254s, training loss at epoch 124: 0.6436
loss: 0.64 time:  12.18 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |  125  |      12.18       |     10.74      | 0.64 | [0.0168001  0.03022488 0.05211907] | [0.01376139 0.01937267 0.02684503] | [0.04431634 0.0754819  0.12790488] | [0.0095118  0.00868312 0.00769231] |
| Valid |  125  |      12.18       |     10.83      | 0.64 | [0.04870464 0.08266467 0.12417996] | [0.04473055 0.05555867 0.06827903] | [0.10520627 0.16645649 0.24373987] | [0.02878761 0.02430193 0.01900558] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 0.64 time:  12.5 s
using time 12.4955s, training loss at epoch 126: 0.6397
loss: 0.64 time:  12.44 s
using time 12.4380s, training loss at epoch 127: 0.6446
loss: 0.64 time:  12.26 s
using time 12.2620s, training loss at epoch 128: 0.6429
loss: 0.64 time:  12.47 s
using time 12.4651s, training loss at epoch 129: 0.6396
loss: 0.64 time:  12.37 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |  130  |      12.37       |     10.86      | 0.64 | [0.01888833 0.03440727 0.05501684] | [0.01544451 0.02197454 0.029049  ] | [0.04845974 0.08466943 0.13655197] | [0.01059269 0.00985408 0.00819672] |
| Valid |  130  |      12.37       |     11.44      | 0.64 | [0.05095803 0.08292213 0.12901518] | [0.04752154 0.05763721 0.07172106] | [0.10934967 0.16933886 0.24968474] | [0.03051702 0.02477031 0.01972618] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 0.64 time:  12.36 s
using time 12.3614s, training loss at epoch 131: 0.6379
loss: 0.64 time:  12.2 s
using time 12.1985s, training loss at epoch 132: 0.6410
loss: 0.64 time:  12.36 s
using time 12.3585s, training loss at epoch 133: 0.6404
loss: 0.64 time:  12.16 s
using time 12.1563s, training loss at epoch 134: 0.6356
loss: 0.64 time:  12.34 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |  135  |      12.34       |     10.78      | 0.64 | [0.01790342 0.03072587 0.05358518] | [0.01459418 0.02006392 0.02783926] | [0.04539723 0.07710322 0.13132769] | [0.01001621 0.00895334 0.00791749] |
| Valid |  135  |      12.34       |     10.93      | 0.64 | [0.05228691 0.08409743 0.1282884 ] | [0.04686544 0.0575515  0.0710619 ] | [0.10934967 0.16861827 0.24355972] | [0.02921996 0.02469825 0.01940191] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 0.64 time:  12.18 s
using time 12.1799s, training loss at epoch 136: 0.6393
loss: 0.64 time:  12.35 s
using time 12.3483s, training loss at epoch 137: 0.6400
loss: 0.64 time:  12.34 s
using time 12.3396s, training loss at epoch 138: 0.6399
loss: 0.63 time:  12.33 s
using time 12.3345s, training loss at epoch 139: 0.6318
loss: 0.64 time:  12.17 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |  140  |      12.17       |     10.96      | 0.64 | [0.01704321 0.03076252 0.05227801] | [0.01359959 0.01949399 0.02690476] | [0.04197442 0.07530175 0.12700414] | [0.00925959 0.00875518 0.00777337] |
| Valid |  140  |      12.17       |     10.85      | 0.64 | [0.04902419 0.08016752 0.12848825] | [0.04634223 0.05561447 0.07054489] | [0.10862908 0.16627635 0.24662223] | [0.02994055 0.0236534  0.01966312] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 0.63 time:  12.33 s
using time 12.3326s, training loss at epoch 141: 0.6340
loss: 0.64 time:  12.37 s
using time 12.3719s, training loss at epoch 142: 0.6375
loss: 0.64 time:  12.4 s
using time 12.4023s, training loss at epoch 143: 0.6403
loss: 0.64 time:  12.44 s
using time 12.4444s, training loss at epoch 144: 0.6360
loss: 0.64 time:  12.43 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |  145  |      12.43       |     10.75      | 0.64 | [0.01588876 0.03027842 0.05349731] | [0.01348617 0.01965681 0.02755883] | [0.0396325  0.07440101 0.12934606] | [0.00875518 0.00864709 0.0078094 ] |
| Valid |  145  |      12.43       |     11.02      | 0.64 | [0.05039529 0.08163172 0.12862282] | [0.04484207 0.05529248 0.07018428] | [0.10862908 0.16537561 0.24716267] | [0.02770672 0.02332913 0.01949198] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 0.64 time:  12.51 s
using time 12.5126s, training loss at epoch 146: 0.6385
loss: 0.64 time:  12.14 s
using time 12.1418s, training loss at epoch 147: 0.6376
loss: 0.63 time:  12.37 s
using time 12.3663s, training loss at epoch 148: 0.6342
loss: 0.63 time:  12.25 s
using time 12.2509s, training loss at epoch 149: 0.6338
loss: 0.64 time:  12.4 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |  150  |       12.4       |     10.95      | 0.64 | [0.01674841 0.03036874 0.05291911] | [0.01418416 0.01985443 0.0275795 ] | [0.04269501 0.07620249 0.13006665] | [0.00954783 0.00880922 0.00788146] |
| Valid |  150  |       12.4       |      10.8      | 0.64 | [0.04896388 0.08124459 0.12435364] | [0.04547315 0.05623279 0.06954589] | [0.10772834 0.1660962  0.23941632] | [0.02767069 0.02336516 0.01887948] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 0.63 time:  12.52 s
using time 12.5227s, training loss at epoch 151: 0.6317
loss: 0.63 time:  12.46 s
using time 12.4640s, training loss at epoch 152: 0.6333
loss: 0.63 time:  12.22 s
using time 12.2205s, training loss at epoch 153: 0.6303
loss: 0.63 time:  12.39 s
using time 12.3916s, training loss at epoch 154: 0.6309
loss: 0.63 time:  12.24 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |  155  |      12.24       |     10.95      | 0.63 | [0.0180554  0.03176412 0.05277916] | [0.01488794 0.02068056 0.0278978 ] | [0.04359575 0.07728337 0.12502252] | [0.00980004 0.00907945 0.00772834] |
| Valid |  155  |      12.24       |     10.78      | 0.63 | [0.04922891 0.08417266 0.13085509] | [0.04394256 0.05600435 0.07061043] | [0.10502612 0.16825797 0.2453612 ] | [0.02705819 0.02370744 0.01969015] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 0.62 time:  12.51 s
using time 12.5072s, training loss at epoch 156: 0.6249
loss: 0.63 time:  12.4 s
using time 12.4000s, training loss at epoch 157: 0.6266
loss: 0.63 time:  12.48 s
using time 12.4776s, training loss at epoch 158: 0.6271
loss: 0.63 time:  12.26 s
using time 12.2550s, training loss at epoch 159: 0.6277
loss: 0.63 time:  12.48 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |  160  |      12.48       |     10.93      | 0.63 | [0.01738844 0.0305122  0.05362172] | [0.01387284 0.01946696 0.02735576] | [0.04215457 0.07458116 0.12970636] | [0.00954783 0.00875518 0.00791749] |
| Valid |  160  |      12.48       |     10.83      | 0.63 | [0.04645382 0.07732413 0.1252807 ] | [0.04194636 0.05235664 0.06736204] | [0.0989011  0.15708881 0.23833544] | [0.02594127 0.02233832 0.01899658] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 0.66 time:  12.46 s
using time 12.4557s, training loss at epoch 161: 0.6646
loss: 1.0 time:  12.27 s
using time 12.2686s, training loss at epoch 162: 1.0043
loss: 0.74 time:  12.4 s
using time 12.4004s, training loss at epoch 163: 0.7396
loss: 0.75 time:  12.4 s
using time 12.3970s, training loss at epoch 164: 0.7493
loss: 0.79 time:  12.35 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |  165  |      12.35       |     10.91      | 0.79 | [0.01594581 0.03026913 0.05397008] | [0.01270396 0.01875939 0.02688585] | [0.04017294 0.07386057 0.13006665] | [0.00864709 0.008539   0.00789948] |
| Valid |  165  |      12.35       |     10.87      | 0.79 | [0.0434909  0.07503007 0.11809577] | [0.03987348 0.05065113 0.06392385] | [0.09259593 0.15114394 0.22968834] | [0.02457215 0.02242839 0.01821293] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 0.68 time:  12.28 s
using time 12.2806s, training loss at epoch 166: 0.6787
loss: 0.68 time:  12.44 s
using time 12.4364s, training loss at epoch 167: 0.6814
loss: 0.63 time:  12.2 s
using time 12.1978s, training loss at epoch 168: 0.6320
loss: 0.63 time:  12.4 s
using time 12.4029s, training loss at epoch 169: 0.6292
loss: 0.63 time:  12.4 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |  170  |       12.4       |     11.01      | 0.63 | [0.01774316 0.03288357 0.05506299] | [0.01414319 0.02048319 0.02815441] | [0.04503693 0.07872455 0.13204828] | [0.00965592 0.00918753 0.00808863] |
| Valid |  170  |       12.4       |     10.96      | 0.63 | [0.0501828  0.08270447 0.13078691] | [0.04470957 0.05565877 0.07019694] | [0.10736804 0.16501531 0.24590164] | [0.02842731 0.02408575 0.01917672] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 0.67 time:  12.48 s
using time 12.4757s, training loss at epoch 171: 0.6720
loss: 0.61 time:  12.2 s
using time 12.1957s, training loss at epoch 172: 0.6062
loss: 0.61 time:  12.36 s
using time 12.3596s, training loss at epoch 173: 0.6089
loss: 0.65 time:  12.14 s
using time 12.1354s, training loss at epoch 174: 0.6482
loss: 0.63 time:  12.37 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |  175  |      12.37       |     10.91      | 0.63 | [0.01690805 0.03152308 0.0536152 ] | [0.0138287  0.01987247 0.02746389] | [0.04287516 0.07620249 0.12952621] | [0.00958386 0.0088993  0.00782742] |
| Valid |  175  |      12.37       |      10.8      | 0.63 | [0.04956303 0.08213992 0.12841592] | [0.0445032  0.05543845 0.06969626] | [0.10592686 0.16699694 0.248784  ] | [0.0279229  0.02410377 0.01968114] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
loss: 0.64 time:  12.42 s
using time 12.4203s, training loss at epoch 176: 0.6421
loss: 0.64 time:  12.36 s
using time 12.3603s, training loss at epoch 177: 0.6410
loss: 0.63 time:  12.16 s
using time 12.1644s, training loss at epoch 178: 0.6344
loss: 0.62 time:  12.4 s
using time 12.3951s, training loss at epoch 179: 0.6220
loss: 0.64 time:  12.42 s
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |  180  |      12.42       |     10.94      | 0.64 | [0.01590275 0.02997322 0.05310166] | [0.01310896 0.01894372 0.02689297] | [0.04035309 0.0713385  0.12862547] | [0.00897136 0.00844893 0.00777337] |
| Valid |  180  |      12.42       |     11.09      | 0.64 | [0.04957126 0.08196929 0.12519302] | [0.04340266 0.05408245 0.06795559] | [0.10610701 0.16789768 0.24464061] | [0.02691407 0.02269861 0.01892452] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
Early stopping is trigger at step: 5 log:0.12519302468023938
early stopping at 180, recall@20:0.1309, best_epoch at 155
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
| Phase | Epoch | training time(s) | tesing time(s) | Loss |               recall               |                ndcg                |             hit_ratio              |             precision              |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
|  Test |  155  |      12.24       |     10.95      | 0.63 | [0.0180554  0.03176412 0.05277916] | [0.01488794 0.02068056 0.0278978 ] | [0.04359575 0.07728337 0.12502252] | [0.00980004 0.00907945 0.00772834] |
+-------+-------+------------------+----------------+------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+
2025-02-11_11-13-03
Seed: 2021
End hyper parameters:  {'dim': 512, 'l2': 1e-06, 'hops': 1}
Best valid_ret['recall']:  0.13085509277607793
[I 2025-02-11 11:13:04,015] Trial 0 finished with value: 0.13085509277607793 and parameters: {'dim': 512, 'l2': 1e-06, 'context_hops': 1}. Best is trial 0 with value: 0.13085509277607793.
{'dim': 512, 'l2': 1e-06, 'context_hops': 1}
time of end:  2025-02-11 11:13:04.015600
finished all
(dirrec) caleb@ubuntu22:~/MCAP$ 